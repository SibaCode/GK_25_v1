<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telkom Distributor Engagement App</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
<style>
body { font-family: 'Poppins', sans-serif; padding-top: 20px; background: #f9f9f9; }
.highlight { background-color: yellow; font-weight: bold; }
h4 { color: #0072c6; }
.card { border-radius: 10px; }
</style>
</head>
<body>
<div class="container">
<h1 class="text-center text-primary mb-4">Telkom Distributor Engagement App</h1>

<!-- Dashboard -->
<div class="card p-3 mb-4" id="dashboard">
  <h4>Dashboard Overview</h4>
  <p>Total Fraud Reports: <span id="totalFraud">0</span></p>
  <p>Total E-Waste Logs: <span id="totalEWaste">0</span></p>
  <p>Total Rewards Earned: R<span id="totalReward">0</span></p>
</div>

<!-- Fraud Reporting Form -->
<div class="card p-3 mb-4">
<h4>SIM Fraud Reporting</h4>
<form id="fraudForm">
  <div class="mb-2"><label>Customer Name</label><input type="text" class="form-control" id="fraudCustomer" required></div>
  <div class="mb-2"><label>SIM Number</label><input type="text" class="form-control" id="fraudSIM" required></div>
  <div class="mb-2"><label>Description</label><textarea class="form-control" id="fraudDesc" required></textarea></div>
  <button class="btn btn-primary mt-2" type="submit">Submit Fraud Report</button>
</form>
<div id="fraudList" class="mt-3"></div>
</div>

<!-- E-Waste Logging Form -->
<div class="card p-3 mb-4">
<h4>E-Waste Logging</h4>
<form id="ewasteForm">
  <div class="mb-2"><label>Customer Name</label><input type="text" class="form-control" id="ewasteCustomer" required></div>
  <div class="mb-2"><label>Items Collected</label><input type="text" class="form-control" id="ewasteItems" required></div>
  <div class="mb-2"><label>Weight (kg)</label><input type="number" class="form-control" id="ewasteWeight" step="0.1" required></div>
  <button class="btn btn-success mt-2" type="submit">Log E-Waste</button>
</form>
<div id="ewasteList" class="mt-3"></div>
</div>

<!-- Telkom Learn -->
<div class="card p-3 mb-4">
<h4>Telkom Learn - Courses & Badges</h4>
<ul id="courseList" class="list-group mb-2"></ul>
<div><strong>Badges Earned:</strong> <span id="badgesContainer"></span></div>
</div>

<!-- Leaderboard -->
<div class="card p-3 mb-4">
<h4>Leaderboard</h4>
<ul id="leaderboardList" class="list-group"></ul>
</div>

<!-- Community Chat -->
<div class="card p-3 mb-4">
<h4>Peer-to-Peer Community</h4>
<form id="chatForm">
  <div class="mb-2"><input type="text" class="form-control" id="chatTitle" placeholder="Post title" required></div>
  <div class="mb-2"><textarea class="form-control" id="chatContent" placeholder="Write your question or tip" required></textarea></div>
  <button class="btn btn-info mt-2" type="submit">Post</button>
</form>
<div id="chatList" class="mt-3"></div>
</div>

</div>

<script>
// ===== Mock Data =====
let distributors = [
  { id: 1, name: "Distributor1", fraudCount: 2, eWasteCount: 3, totalReward: 50, badges: ["Fraud Fighter","Eco Champion"] },
  { id: 2, name: "Distributor2", fraudCount: 1, eWasteCount: 1, totalReward: 10, badges: ["Eco Champion"] }
];

let fraudReports = [
  { id: 1, distributorId: 1, customerName: "John Doe", simNumber: "0812345678", description: "SIM card used in scam call", timestamp: "2025-09-24 10:00" },
  { id: 2, distributorId: 1, customerName: "Alice Brown", simNumber: "0823456789", description: "Unauthorized duplication of SIM", timestamp: "2025-09-24 10:30" },
  { id: 3, distributorId: 2, customerName: "Mark Green", simNumber: "0834567890", description: "Fake SIM registered", timestamp: "2025-09-24 11:00" }
];

let eWasteLogs = [
  { id: 1, distributorId: 1, customerName: "Jane 4444444Smith", itemsCollected: "Old SIMs, Phone", weight: 2.5, reward: 25, timestamp: "2025-09-24 11:00" },
  { id: 2, distributorId: 1, customerName: "Tom White", itemsCollected: "Old Router", weight: 1.5, reward: 15, timestamp: "2025-09-24 11:30" },
  { id: 3, distributorId: 2, customerName: "Linda Grey", itemsCollected: "Old SIMs", weight: 1, reward: 10, timestamp: "2025-09-24 12:00" }
];

let courses = [
  { id: 1, name: "Fraud Prevention", description: "Learn to detect SIM fraud" },
  { id: 2, name: "Customer Service", description: "Tips for excellent customer service" },
  { id: 3, name: "Sustainability Practices", description: "E-waste management & recycling" }
];

let distributorCourses = [
  { distributorId: 1, courseId: 1, completedAt: "2025-09-24 12:00" },
  { distributorId: 1, courseId: 3, completedAt: "2025-09-24 12:30" },
  { distributorId: 2, courseId: 3, completedAt: "2025-09-24 12:45" }
];

let communityPosts = [
  { id: 1, distributorId: 1, title: "SIM Scam Advice", content: "How to detect duplicate SIM calls", timestamp: "2025-09-24 13:00" },
  { id: 2, distributorId: 2, title: "E-Waste Tips", content: "Best way to weigh and track old SIMs", timestamp: "2025-09-24 13:30" }
];

// ===== UI Update Functions =====
function updateDashboard() {
  let totalFraud = fraudReports.length;
  let totalEWaste = eWasteLogs.length;
  let totalReward = distributors.reduce((sum, d) => sum + d.totalReward, 0);
  document.getElementById("totalFraud").innerText = totalFraud;
  document.getElementById("totalEWaste").innerText = totalEWaste;
  document.getElementById("totalReward").innerText = totalReward.toFixed(2);
}

function updateFraudList() {
  const list = document.getElementById("fraudList");
  list.innerHTML = "<h6>Submitted Fraud Reports:</h6>";
  const keywords = ["scam","duplicate","unauthorized","fake"];
  fraudReports.forEach(r => {
    let desc = r.description;
    keywords.forEach(word => {
      const regex = new RegExp(`\\b(${word})\\b`, "gi");
      desc = desc.replace(regex, "<span class='highlight'>$1</span>");
    });
    list.innerHTML += `<p><strong>${r.customerName}</strong> - ${r.simNumber}: ${desc}</p>`;
  });
}

function updateEWasteList() {
  const list = document.getElementById("ewasteList");
  list.innerHTML = "<h6>E-Waste Logs:</h6>";
  eWasteLogs.forEach(e => {
    list.innerHTML += `<p><strong>${e.customerName}</strong> - ${e.itemsCollected} (Weight: ${e.weight}kg, Reward: R${e.reward})</p>`;
  });
}

function updateCourses() {
  const container = document.getElementById("courseList");
  container.innerHTML = "";
  courses.forEach(c => {
    let completed = distributorCourses.some(dc => dc.distributorId === 1 && dc.courseId === c.id);
    container.innerHTML += `<li class="list-group-item">${c.name} <button class="btn btn-sm btn-outline-success float-end" ${completed?'disabled':'onclick="completeCourse('+c.id+')"'}>${completed?'Completed':'Complete'}</button></li>`;
  });
}

function completeCourse(courseId) {
  distributorCourses.push({ distributorId: 1, courseId: courseId, completedAt: new Date().toISOString() });
  distributors[0].badges.push(courses.find(c=>c.id===courseId).name);
  updateCourses(); updateBadges(); updateLeaderboard();
}

function updateBadges() {
  document.getElementById("badgesContainer").innerText = distributors[0].badges.join(", ");
}

function updateLeaderboard() {
  const list = document.getElementById("leaderboardList");
  list.innerHTML = "";
  distributors.sort((a,b) => (b.fraudCount + b.eWasteCount) - (a.fraudCount + a.eWasteCount));
  distributors.forEach(d => {
    list.innerHTML += `<li class="list-group-item">${d.name} - Reports: ${d.fraudCount}, E-Waste: ${d.eWasteCount}, Reward: R${d.totalReward.toFixed(2)}, Badges: ${d.badges.join(", ")}</li>`;
  });
}

function updateCommunity() {
  const list = document.getElementById("chatList");
  list.innerHTML = "<h6>Community Posts:</h6>";
  communityPosts.forEach(p => {
    list.innerHTML += `<p><strong>${p.title}</strong>: ${p.content}</p>`;
  });
}

// ===== Event Listeners =====
document.getElementById("fraudForm").addEventListener("submit", e=>{
  e.preventDefault();
  const customerName = document.getElementById("fraudCustomer").value;
  const simNumber = document.getElementById("fraudSIM").value;
  const description = document.getElementById("fraudDesc").value;
  const newId = fraudReports.length+1;
  fraudReports.push({ id:newId, distributorId:1, customerName, simNumber, description, timestamp:new Date().toISOString() });
  distributors[0].fraudCount++;
  updateDashboard(); updateFraudList(); updateLeaderboard();
  e.target.reset();
});

document.getElementById("ewasteForm").addEventListener("submit", e=>{
  e.preventDefault();
  const customerName = document.getElementById("ewasteCustomer").value;
  const itemsCollected = document.getElementById("ewasteItems").value;
  const weight = parseFloat(document.getElementById("ewasteWeight").value);
  const reward = weight * 10;
  const newId = eWasteLogs.length+1;
  eWasteLogs.push({ id:newId, distributorId:1, customerName, itemsCollected, weight, reward, timestamp:new Date().toISOString() });
  distributors[0].eWasteCount++; distributors[0].totalReward += reward;
  updateDashboard(); updateEWasteList(); updateLeaderboard();
  e.target.reset();
});

document.getElementById("chatForm").addEventListener("submit", e=>{
  e.preventDefault();
  const title = document.getElementById("chatTitle").value;
  const content = document.getElementById("chatContent").value;
  const newId = communityPosts.length+1;
  communityPosts.push({ id:newId, distributorId:1, title, content, timestamp:new Date().toISOString() });
  updateCommunity(); e.target.reset();
});

// ===== Initial Load =====
updateDashboard(); updateFraudList(); updateEWasteList(); updateCourses(); updateBadges(); updateLeaderboard(); updateCommunity();
</script>
</body>
</html>
